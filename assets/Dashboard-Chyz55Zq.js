import{d as G,r as g,o as M,a as j,c as v,b as t,w as p,e as q,f as l,g as e,i as b,E as D,h as k,j as s,t as x,u as E,k as U,T as u,l as W,m as X,n as H,p as J,q as o,_ as K}from"./index-L8zpvlSD.js";import{i as A,L as P}from"./index-5QPu3XI4.js";const Q={class:"dashboard-container"},Y={class:"stats-cards"},Z={class:"stat-info"},$={class:"stat-number"},ee={class:"stat-icon employees"},te={class:"stat-info"},ae={class:"stat-number"},se={class:"stat-icon departments"},oe={class:"stat-info"},ne={class:"stat-number"},le={class:"stat-icon attendance"},de={class:"stat-info"},re={class:"stat-number"},ie={class:"stat-icon leaves"},ce={class:"charts"},pe={class:"charts"},ue={class:"recent-data"},_e=G({__name:"Dashboard",setup(ve){const w=g(!0),m=g(!0),B=g(!0),r=g({total_employees:0,total_departments:0,today_attendance:0,pending_leaves:0}),S=g([]),z=g([]);let f=null,h=null,y=null;const O=async()=>{try{const n=await b.get("/api/reports/stats");r.value=n.data.data}catch{D.error("获取统计数据失败")}finally{w.value=!1}},F=async()=>{try{const n=await b.get("/api/reports/recent");S.value=n.data.data.recent_employees,z.value=n.data.data.pending_leaves}catch{D.error("获取最近数据失败")}finally{B.value=!1}},N=async()=>{try{const a=(await b.get("/api/reports/department-distribution")).data.data;f&&f.dispose(),f=A(document.getElementById("department-chart"));const d={title:{text:"",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"部门员工分布",type:"pie",radius:"70%",center:["50%","60%"],data:a,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};f.setOption(d)}catch{D.error("获取部门分布数据失败")}finally{m.value=!1}},R=async()=>{try{const a=(await b.get("/api/reports/gender-distribution")).data.data;h&&h.dispose(),h=A(document.getElementById("gender-chart"));const d={title:{text:"",left:"center"},tooltip:{trigger:"item"},xAxis:{type:"category",data:["男","女"]},yAxis:{type:"value"},series:[{data:[{value:a.male,itemStyle:{color:"#409EFF"}},{value:a.female,itemStyle:{color:"#F7BA2A"}}],type:"bar",barWidth:"60%"}]};h.setOption(d)}catch{D.error("获取性别分布数据失败")}finally{m.value=!1}},T=async()=>{try{const a=(await b.get("/api/reports/attendance-stats")).data.data;y&&y.dispose(),y=A(document.getElementById("attendance-chart"));const d={title:{text:"",left:"center"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:a.dates},yAxis:{type:"value"},series:[{name:"出勤人数",data:a.counts,type:"line",smooth:!0,lineStyle:{color:"#67C23A"},areaStyle:{color:new P(0,0,0,1,[{offset:0,color:"rgba(103, 194, 58, 0.5)"},{offset:1,color:"rgba(103, 194, 58, 0.1)"}])}}]};y.setOption(d)}catch{D.error("获取考勤统计数据失败")}finally{m.value=!1}},L=()=>{f?.resize(),h?.resize(),y?.resize()};return M(()=>{O(),F(),N(),R(),T(),window.addEventListener("resize",L)}),j(()=>{window.removeEventListener("resize",L),f?.dispose(),h?.dispose(),y?.dispose()}),(n,a)=>{const d=k("el-icon"),i=k("el-card"),_=k("el-table-column"),I=k("el-table"),V=k("el-tag"),c=q("loading");return o(),v("div",Q,[t("div",Y,[p((o(),l(i,{shadow:"hover",class:"stat-card"},{default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{class:"stat-content",key:r.value.total_employees},[t("div",Z,[t("div",$,x(r.value.total_employees),1),a[0]||(a[0]=t("div",{class:"stat-label"},"总员工数",-1))]),t("div",ee,[s(d,null,{default:e(()=>[s(E(U))]),_:1})])]))]),_:1})]),_:1})),[[c,w.value]]),p((o(),l(i,{shadow:"hover",class:"stat-card"},{default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{class:"stat-content",key:r.value.total_departments},[t("div",te,[t("div",ae,x(r.value.total_departments),1),a[1]||(a[1]=t("div",{class:"stat-label"},"总部门数",-1))]),t("div",se,[s(d,null,{default:e(()=>[s(E(W))]),_:1})])]))]),_:1})]),_:1})),[[c,w.value]]),p((o(),l(i,{shadow:"hover",class:"stat-card"},{default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{class:"stat-content",key:r.value.today_attendance},[t("div",oe,[t("div",ne,x(r.value.today_attendance),1),a[2]||(a[2]=t("div",{class:"stat-label"},"今日考勤",-1))]),t("div",le,[s(d,null,{default:e(()=>[s(E(X))]),_:1})])]))]),_:1})]),_:1})),[[c,w.value]]),p((o(),l(i,{shadow:"hover",class:"stat-card"},{default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{class:"stat-content",key:r.value.pending_leaves},[t("div",de,[t("div",re,x(r.value.pending_leaves),1),a[3]||(a[3]=t("div",{class:"stat-label"},"待审批",-1))]),t("div",ie,[s(d,null,{default:e(()=>[s(E(H))]),_:1})])]))]),_:1})]),_:1})),[[c,w.value]])]),t("div",ce,[p((o(),l(i,{shadow:"hover",class:"chart-card"},{header:e(()=>[...a[4]||(a[4]=[t("div",{class:"card-header"},[t("span",null,"部门员工分布")],-1)])]),default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{id:"department-chart",class:"chart",key:"department-chart-"+Date.now()}))]),_:1})]),_:1})),[[c,m.value]]),p((o(),l(i,{shadow:"hover",class:"chart-card"},{header:e(()=>[...a[5]||(a[5]=[t("div",{class:"card-header"},[t("span",null,"员工性别分布")],-1)])]),default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{id:"gender-chart",class:"chart",key:"gender-chart-"+Date.now()}))]),_:1})]),_:1})),[[c,m.value]])]),t("div",pe,[p((o(),l(i,{shadow:"hover",class:"chart-card full-width"},{header:e(()=>[...a[6]||(a[6]=[t("div",{class:"card-header"},[t("span",null,"最近7天考勤统计")],-1)])]),default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),v("div",{id:"attendance-chart",class:"chart",key:"attendance-chart-"+Date.now()}))]),_:1})]),_:1})),[[c,m.value]])]),t("div",ue,[p((o(),l(i,{shadow:"hover",class:"data-card"},{header:e(()=>[...a[7]||(a[7]=[t("div",{class:"card-header"},[t("span",null,"最近新增员工")],-1)])]),default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),l(I,{data:S.value,stripe:"",style:{width:"100%"},key:"recent-employees-"+Date.now()},{default:e(()=>[s(_,{prop:"name",label:"姓名"}),s(_,{prop:"department_name",label:"部门"}),s(_,{prop:"position",label:"职位"}),s(_,{prop:"hire_date",label:"入职日期",width:"120"})]),_:1},8,["data"]))]),_:1})]),_:1})),[[c,B.value]]),p((o(),l(i,{shadow:"hover",class:"data-card"},{header:e(()=>[...a[8]||(a[8]=[t("div",{class:"card-header"},[t("span",null,"待审批请假")],-1)])]),default:e(()=>[s(u,{name:"fade",mode:"out-in"},{default:e(()=>[(o(),l(I,{data:z.value,stripe:"",style:{width:"100%"},key:"pending-leaves-"+Date.now()},{default:e(()=>[s(_,{prop:"employee_name",label:"员工"}),s(_,{prop:"leave_type",label:"类型",width:"100"},{default:e(C=>[s(V,{type:C.row.leave_type==="annual"?"primary":C.row.leave_type==="sick"?"warning":"info"},{default:e(()=>[J(x(C.row.leave_type==="annual"?"年假":C.row.leave_type==="sick"?"病假":"事假"),1)]),_:2},1032,["type"])]),_:1}),s(_,{prop:"days",label:"天数",width:"80"}),s(_,{prop:"created_at",label:"申请时间",width:"160"})]),_:1},8,["data"]))]),_:1})]),_:1})),[[c,B.value]])])])}}}),he=K(_e,[["__scopeId","data-v-93b2d6db"]]);export{he as default};
