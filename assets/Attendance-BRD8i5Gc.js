import{d as j,r as i,n as F,o as R,c as q,e,w as t,f as o,i as y,E as u,b as m,B as G,l as g,C as H,z as J,t as w,u as K,I as L,m as C,_ as O}from"./index-BKuDftu-.js";const Q={class:"attendance-container"},W={class:"card-header"},X={class:"search-form"},Z={class:"pagination"},$=j({__name:"Attendance",setup(ee){const b=i([]),v=i(!1),k=i(0),d=i(1),p=i(10),_=i(!1),s=F({employee_name:"",date_range:[]}),c=async()=>{v.value=!0;try{const l={page:d.value,per_page:p.value,employee_name:s.employee_name,start_date:s.date_range?.[0],end_date:s.date_range?.[1]},a=await y.get("/api/attendances",{params:l});b.value=a.data.data,k.value=a.data.total}catch{u.error("获取考勤列表失败")}finally{v.value=!1}},z=async()=>{try{await y.post("/api/attendances/check-in"),u.success("打卡成功"),_.value=!0,c()}catch{u.error("打卡失败")}},V=async()=>{try{const l=await y.get("/api/attendances/today");_.value=l.data.data.is_checked_in}catch{u.error("获取打卡状态失败")}},D=()=>{d.value=1,c()},Y=()=>{s.employee_name="",s.date_range=[],d.value=1,c()},S=l=>{p.value=l,c()},x=l=>{d.value=l,c()};return R(()=>{V(),c()}),(l,a)=>{const I=o("el-icon"),f=o("el-button"),M=o("el-input"),h=o("el-form-item"),B=o("el-date-picker"),U=o("el-form"),r=o("el-table-column"),A=o("el-tag"),E=o("el-table"),N=o("el-pagination"),P=o("el-card"),T=H("loading");return C(),q("div",Q,[e(P,null,{header:t(()=>[m("div",W,[a[4]||(a[4]=m("span",null,"考勤管理",-1)),e(f,{type:"primary",onClick:z,disabled:_.value},{default:t(()=>[e(I,null,{default:t(()=>[e(K(L))]),_:1}),g(" "+w(_.value?"今日已打卡":"打卡"),1)]),_:1},8,["disabled"])])]),default:t(()=>[m("div",X,[e(U,{inline:!0,model:s,class:"demo-form-inline"},{default:t(()=>[e(h,{label:"员工姓名"},{default:t(()=>[e(M,{modelValue:s.employee_name,"onUpdate:modelValue":a[0]||(a[0]=n=>s.employee_name=n),placeholder:"请输入员工姓名"},null,8,["modelValue"])]),_:1}),e(h,{label:"日期范围"},{default:t(()=>[e(B,{modelValue:s.date_range,"onUpdate:modelValue":a[1]||(a[1]=n=>s.date_range=n),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(h,null,{default:t(()=>[e(f,{type:"primary",onClick:D},{default:t(()=>[...a[5]||(a[5]=[g("查询",-1)])]),_:1}),e(f,{onClick:Y},{default:t(()=>[...a[6]||(a[6]=[g("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),G((C(),J(E,{data:b.value,border:"",stripe:"",style:{width:"100%"}},{default:t(()=>[e(r,{prop:"id",label:"ID",width:"80"}),e(r,{prop:"employee_name",label:"员工姓名"}),e(r,{prop:"department_name",label:"部门"}),e(r,{prop:"check_in_time",label:"上班打卡",width:"150"}),e(r,{prop:"check_out_time",label:"下班打卡",width:"150"}),e(r,{prop:"status",label:"状态",width:"100"},{default:t(n=>[e(A,{type:n.row.status===1?"success":n.row.status===0?"danger":"warning"},{default:t(()=>[g(w(n.row.status===1?"正常":n.row.status===0?"缺勤":"迟到"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"check_in_ip",label:"打卡IP",width:"120"})]),_:1},8,["data"])),[[T,v.value]]),m("div",Z,[e(N,{"current-page":d.value,"onUpdate:currentPage":a[2]||(a[2]=n=>d.value=n),"page-size":p.value,"onUpdate:pageSize":a[3]||(a[3]=n=>p.value=n),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:k.value,onSizeChange:S,onCurrentChange:x},null,8,["current-page","page-size","total"])])]),_:1})])}}}),te=O($,[["__scopeId","data-v-15b9667b"]]);export{te as default};
