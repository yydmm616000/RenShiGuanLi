import{d as j,r as i,s as q,o as F,c as R,j as e,g as t,h as l,i as y,E as u,b as m,p as g,T as G,w as H,e as J,f as K,t as w,u as L,I as O,q as C,_ as Q}from"./index-L8zpvlSD.js";const W={class:"attendance-container"},X={class:"card-header"},Z={class:"search-form"},$={class:"pagination"},ee=j({__name:"Attendance",setup(ae){const b=i([]),f=i(!1),k=i(0),d=i(1),p=i(10),_=i(!1),s=q({employee_name:"",date_range:[]}),c=async()=>{f.value=!0;try{const o={page:d.value,per_page:p.value,employee_name:s.employee_name,start_date:s.date_range?.[0],end_date:s.date_range?.[1]},a=await y.get("/api/attendance",{params:o});b.value=a.data.data,k.value=a.data.total}catch{u.error("获取考勤列表失败")}finally{f.value=!1}},D=async()=>{try{await y.post("/api/attendance/check-in"),u.success("打卡成功"),_.value=!0,c()}catch{u.error("打卡失败")}},V=async()=>{try{const o=await y.get("/api/attendance/today");_.value=o.data.data.is_checked_in}catch{u.error("获取打卡状态失败")}},z=()=>{d.value=1,c()},Y=()=>{s.employee_name="",s.date_range=[],d.value=1,c()},S=o=>{p.value=o,c()},x=o=>{d.value=o,c()};return F(()=>{V(),c()}),(o,a)=>{const I=l("el-icon"),v=l("el-button"),M=l("el-input"),h=l("el-form-item"),B=l("el-date-picker"),T=l("el-form"),r=l("el-table-column"),U=l("el-tag"),A=l("el-table"),E=l("el-pagination"),N=l("el-card"),P=J("loading");return C(),R("div",W,[e(N,null,{header:t(()=>[m("div",X,[a[4]||(a[4]=m("span",null,"考勤管理",-1)),e(v,{type:"primary",onClick:D,disabled:_.value},{default:t(()=>[e(I,null,{default:t(()=>[e(L(O))]),_:1}),g(" "+w(_.value?"今日已打卡":"打卡"),1)]),_:1},8,["disabled"])])]),default:t(()=>[m("div",Z,[e(T,{inline:!0,model:s,class:"demo-form-inline"},{default:t(()=>[e(h,{label:"员工姓名"},{default:t(()=>[e(M,{modelValue:s.employee_name,"onUpdate:modelValue":a[0]||(a[0]=n=>s.employee_name=n),placeholder:"请输入员工姓名"},null,8,["modelValue"])]),_:1}),e(h,{label:"日期范围"},{default:t(()=>[e(B,{modelValue:s.date_range,"onUpdate:modelValue":a[1]||(a[1]=n=>s.date_range=n),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(h,null,{default:t(()=>[e(v,{type:"primary",onClick:z},{default:t(()=>[...a[5]||(a[5]=[g("查询",-1)])]),_:1}),e(v,{onClick:Y},{default:t(()=>[...a[6]||(a[6]=[g("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),e(G,{name:"fade",mode:"out-in"},{default:t(()=>[H((C(),K(A,{data:b.value,border:"",stripe:"",style:{width:"100%"},key:"attendance-table-"+Date.now()},{default:t(()=>[e(r,{prop:"id",label:"ID",width:"80"}),e(r,{prop:"employee_name",label:"员工姓名"}),e(r,{prop:"department_name",label:"部门"}),e(r,{prop:"check_in_time",label:"上班打卡",width:"150"}),e(r,{prop:"check_out_time",label:"下班打卡",width:"150"}),e(r,{prop:"status",label:"状态",width:"100"},{default:t(n=>[e(U,{type:n.row.status===1?"success":n.row.status===0?"danger":"warning"},{default:t(()=>[g(w(n.row.status===1?"正常":n.row.status===0?"缺勤":"迟到"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"check_in_ip",label:"打卡IP",width:"120"})]),_:1},8,["data"])),[[P,f.value]])]),_:1}),m("div",$,[e(E,{"current-page":d.value,"onUpdate:currentPage":a[2]||(a[2]=n=>d.value=n),"page-size":p.value,"onUpdate:pageSize":a[3]||(a[3]=n=>p.value=n),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:k.value,onSizeChange:S,onCurrentChange:x},null,8,["current-page","page-size","total"])])]),_:1})])}}}),ne=Q(ee,[["__scopeId","data-v-e17f8a42"]]);export{ne as default};
