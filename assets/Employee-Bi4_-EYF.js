import{d as _e,r as m,n as T,o as ve,c as F,e as l,w as a,f as d,i as b,E as p,b as f,B as ce,F as M,y as N,l as u,C as ge,z as $,t as A,u as x,s as be,v as ye,x as Ve,D as we,G as xe,H as Ce,A as ke,m as C,_ as Ue}from"./index-BKuDftu-.js";const De={class:"employee-container"},Ee={class:"card-header"},ze={class:"search-form"},Se={class:"pagination"},he={class:"dialog-footer"},Be={class:"dialog-footer"},Fe=_e({__name:"Employee",setup($e){const j=m([]),h=m([]),B=m(!1),L=m(0),y=m(1),z=m(10),_=T({name:"",department_id:"",status:""}),V=m(!1),k=m(!1),U=m(),o=T({id:"",name:"",gender:1,age:25,department_id:"",position:"",phone:"",email:"",hire_date:new Date,status:1}),D=m(!1),g=m([]),P=async()=>{try{const n=await b.get("/api/departments");h.value=n.data.data}catch{p.error("获取部门列表失败")}},c=async()=>{B.value=!0;try{const n={page:y.value,per_page:z.value,..._},e=await b.get("/api/employees",{params:n});j.value=e.data.data,L.value=e.data.total}catch{p.error("获取员工列表失败")}finally{B.value=!1}},G=()=>{k.value=!1,K(),V.value=!0},H=n=>{k.value=!0,Object.assign(o,n),V.value=!0},q=n=>{ke.confirm("确定要删除该员工吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await b.delete(`/api/employees/${n.id}`),p.success("删除成功"),c()}catch{p.error("删除失败")}}).catch(()=>{p.info("已取消删除")})},J=async()=>{U.value&&await U.value.validate(async n=>{if(n)try{k.value?(await b.put(`/api/employees/${o.id}`,o),p.success("编辑成功")):(await b.post("/api/employees",o),p.success("新增成功")),V.value=!1,c()}catch{p.error(k.value?"编辑失败":"新增失败")}})},K=()=>{U.value&&U.value.resetFields(),Object.assign(o,{id:"",name:"",gender:1,age:25,department_id:"",position:"",phone:"",email:"",hire_date:new Date,status:1})},Q=()=>{y.value=1,c()},W=()=>{Object.assign(_,{name:"",department_id:"",status:""}),y.value=1,c()},X=n=>{z.value=n,c()},Y=n=>{y.value=n,c()},Z=()=>{D.value=!0},ee=n=>{g.value=[n]},le=async()=>{if(g.value.length===0){p.warning("请选择要导入的文件");return}const n=new FormData;if(g.value[0]&&g.value[0].raw)n.append("file",g.value[0].raw);else{p.warning("文件格式错误");return}try{await b.post("/api/employees/import",n,{headers:{"Content-Type":"multipart/form-data"}}),p.success("导入成功"),D.value=!1,g.value=[],c()}catch{p.error("导入失败")}},ae=async()=>{try{const n=await b.get("/api/employees/export",{responseType:"blob"}),e=new Blob([n.data],{type:"application/vnd.ms-excel"}),v=URL.createObjectURL(e),s=document.createElement("a");s.href=v,s.download=`员工列表_${new Date().toISOString().slice(0,10)}.xlsx`,s.click(),URL.revokeObjectURL(v)}catch{p.error("导出失败")}};return ve(()=>{P(),c()}),(n,e)=>{const v=d("el-icon"),s=d("el-button"),te=d("el-button-group"),E=d("el-input"),r=d("el-form-item"),w=d("el-option"),S=d("el-select"),O=d("el-form"),i=d("el-table-column"),oe=d("el-tag"),ne=d("el-table"),de=d("el-pagination"),se=d("el-card"),I=d("el-radio"),ue=d("el-radio-group"),re=d("el-input-number"),pe=d("el-date-picker"),R=d("el-dialog"),ie=d("el-upload"),me=ge("loading");return C(),F("div",De,[l(se,null,{header:a(()=>[f("div",Ee,[e[21]||(e[21]=f("span",null,"员工管理",-1)),l(te,null,{default:a(()=>[l(s,{type:"primary",onClick:G},{default:a(()=>[l(v,null,{default:a(()=>[l(x(Ve))]),_:1}),e[18]||(e[18]=u(" 新增员工 ",-1))]),_:1}),l(s,{type:"success",onClick:Z},{default:a(()=>[l(v,null,{default:a(()=>[l(x(we))]),_:1}),e[19]||(e[19]=u(" 导入Excel ",-1))]),_:1}),l(s,{type:"info",onClick:ae},{default:a(()=>[l(v,null,{default:a(()=>[l(x(xe))]),_:1}),e[20]||(e[20]=u(" 导出Excel ",-1))]),_:1})]),_:1})])]),default:a(()=>[f("div",ze,[l(O,{inline:!0,model:_,class:"demo-form-inline"},{default:a(()=>[l(r,{label:"员工姓名"},{default:a(()=>[l(E,{modelValue:_.name,"onUpdate:modelValue":e[0]||(e[0]=t=>_.name=t),placeholder:"请输入员工姓名"},null,8,["modelValue"])]),_:1}),l(r,{label:"部门"},{default:a(()=>[l(S,{modelValue:_.department_id,"onUpdate:modelValue":e[1]||(e[1]=t=>_.department_id=t),placeholder:"请选择部门"},{default:a(()=>[(C(!0),F(M,null,N(h.value,t=>(C(),$(w,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"状态"},{default:a(()=>[l(S,{modelValue:_.status,"onUpdate:modelValue":e[2]||(e[2]=t=>_.status=t),placeholder:"请选择状态"},{default:a(()=>[l(w,{label:"在职",value:1}),l(w,{label:"离职",value:0})]),_:1},8,["modelValue"])]),_:1}),l(r,null,{default:a(()=>[l(s,{type:"primary",onClick:Q},{default:a(()=>[...e[22]||(e[22]=[u("查询",-1)])]),_:1}),l(s,{onClick:W},{default:a(()=>[...e[23]||(e[23]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),ce((C(),$(ne,{data:j.value,border:"",stripe:"",style:{width:"100%"}},{default:a(()=>[l(i,{prop:"id",label:"ID",width:"80"}),l(i,{prop:"name",label:"姓名"}),l(i,{prop:"gender",label:"性别",width:"80"},{default:a(t=>[f("span",null,A(t.row.gender===1?"男":"女"),1)]),_:1}),l(i,{prop:"age",label:"年龄",width:"80"}),l(i,{prop:"department_name",label:"部门"}),l(i,{prop:"position",label:"职位"}),l(i,{prop:"phone",label:"手机号"}),l(i,{prop:"email",label:"邮箱"}),l(i,{prop:"hire_date",label:"入职日期",width:"120"}),l(i,{prop:"status",label:"状态",width:"80"},{default:a(t=>[l(oe,{type:t.row.status===1?"success":"danger"},{default:a(()=>[u(A(t.row.status===1?"在职":"离职"),1)]),_:2},1032,["type"])]),_:1}),l(i,{label:"操作",width:"180",fixed:"right"},{default:a(t=>[l(s,{size:"small",type:"primary",onClick:fe=>H(t.row)},{default:a(()=>[l(v,null,{default:a(()=>[l(x(be))]),_:1}),e[24]||(e[24]=u(" 编辑 ",-1))]),_:1},8,["onClick"]),l(s,{size:"small",type:"danger",onClick:fe=>q(t.row)},{default:a(()=>[l(v,null,{default:a(()=>[l(x(ye))]),_:1}),e[25]||(e[25]=u(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,B.value]]),f("div",Se,[l(de,{"current-page":y.value,"onUpdate:currentPage":e[3]||(e[3]=t=>y.value=t),"page-size":z.value,"onUpdate:pageSize":e[4]||(e[4]=t=>z.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:L.value,onSizeChange:X,onCurrentChange:Y},null,8,["current-page","page-size","total"])])]),_:1}),l(R,{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=t=>V.value=t),title:k.value?"编辑员工":"新增员工",width:"600px"},{footer:a(()=>[f("span",he,[l(s,{onClick:e[14]||(e[14]=t=>V.value=!1)},{default:a(()=>[...e[28]||(e[28]=[u("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:J},{default:a(()=>[...e[29]||(e[29]=[u("确定",-1)])]),_:1})])]),default:a(()=>[l(O,{ref_key:"employeeForm",ref:U,model:o,"label-width":"100px",rules:"rules"},{default:a(()=>[l(r,{label:"姓名",prop:"name"},{default:a(()=>[l(E,{modelValue:o.name,"onUpdate:modelValue":e[5]||(e[5]=t=>o.name=t),placeholder:"请输入员工姓名"},null,8,["modelValue"])]),_:1}),l(r,{label:"性别",prop:"gender"},{default:a(()=>[l(ue,{modelValue:o.gender,"onUpdate:modelValue":e[6]||(e[6]=t=>o.gender=t)},{default:a(()=>[l(I,{label:"1"},{default:a(()=>[...e[26]||(e[26]=[u("男",-1)])]),_:1}),l(I,{label:"0"},{default:a(()=>[...e[27]||(e[27]=[u("女",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"年龄",prop:"age"},{default:a(()=>[l(re,{modelValue:o.age,"onUpdate:modelValue":e[7]||(e[7]=t=>o.age=t),min:18,max:65},null,8,["modelValue"])]),_:1}),l(r,{label:"部门",prop:"department_id"},{default:a(()=>[l(S,{modelValue:o.department_id,"onUpdate:modelValue":e[8]||(e[8]=t=>o.department_id=t),placeholder:"请选择部门"},{default:a(()=>[(C(!0),F(M,null,N(h.value,t=>(C(),$(w,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"职位",prop:"position"},{default:a(()=>[l(E,{modelValue:o.position,"onUpdate:modelValue":e[9]||(e[9]=t=>o.position=t),placeholder:"请输入职位"},null,8,["modelValue"])]),_:1}),l(r,{label:"手机号",prop:"phone"},{default:a(()=>[l(E,{modelValue:o.phone,"onUpdate:modelValue":e[10]||(e[10]=t=>o.phone=t),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(r,{label:"邮箱",prop:"email"},{default:a(()=>[l(E,{modelValue:o.email,"onUpdate:modelValue":e[11]||(e[11]=t=>o.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(r,{label:"入职日期",prop:"hire_date"},{default:a(()=>[l(pe,{modelValue:o.hire_date,"onUpdate:modelValue":e[12]||(e[12]=t=>o.hire_date=t),type:"date",placeholder:"选择入职日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(r,{label:"状态",prop:"status"},{default:a(()=>[l(S,{modelValue:o.status,"onUpdate:modelValue":e[13]||(e[13]=t=>o.status=t),placeholder:"请选择状态"},{default:a(()=>[l(w,{label:"在职",value:1}),l(w,{label:"离职",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(R,{modelValue:D.value,"onUpdate:modelValue":e[17]||(e[17]=t=>D.value=t),title:"导入Excel",width:"500px"},{footer:a(()=>[f("span",Be,[l(s,{onClick:e[16]||(e[16]=t=>D.value=!1)},{default:a(()=>[...e[32]||(e[32]=[u("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:le},{default:a(()=>[...e[33]||(e[33]=[u("导入",-1)])]),_:1})])]),default:a(()=>[l(ie,{ref:"upload","auto-upload":!1,limit:1,"file-list":g.value,accept:".xlsx, .xls","on-change":ee,drag:""},{tip:a(()=>[...e[30]||(e[30]=[f("div",{class:"el-upload__tip"}," 支持扩展名：.xlsx, .xls ",-1)])]),default:a(()=>[l(v,{class:"el-icon--upload"},{default:a(()=>[l(x(Ce))]),_:1}),e[31]||(e[31]=f("div",{class:"el-upload__text"},[u(" 将文件拖到此处，或"),f("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1},8,["modelValue"])])}}}),Le=Ue(Fe,[["__scopeId","data-v-ea301999"]]);export{Le as default};
